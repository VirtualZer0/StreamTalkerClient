<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:StreamTalkerClient.ViewModels.Wizard"
             xmlns:models="using:StreamTalkerClient.Models"
             x:Class="StreamTalkerClient.Views.Wizard.ServerLaunchView"
             x:DataType="vm:FirstLaunchWizardViewModel">
    <StackPanel Spacing="32" MaxWidth="480" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="40">
        <!-- Loading Icon -->
        <PathIcon Data="{StaticResource SemiIconLoading}"
                  Width="72" Height="72"
                  HorizontalAlignment="Center"
                  Foreground="{DynamicResource SemiPrimaryBrush}"
                  Classes="spinning" />

        <!-- Status Message -->
        <Border BorderBrush="#4080C0"
                BorderThickness="2"
                CornerRadius="8"
                Padding="16"
                Background="#1A3050">
            <StackPanel Spacing="12">
                <TextBlock Text="{Binding StatusMessage}"
                           TextWrapping="Wrap"
                           FontSize="15"
                           TextAlignment="Center"
                           LineHeight="22" />

                <ProgressBar IsIndeterminate="True"
                             IsVisible="{Binding IsLoading}"
                             Height="4" />
            </StackPanel>
        </Border>

        <!-- Error Message (if timeout or failure) -->
        <Border BorderBrush="#E04040"
                BorderThickness="2"
                CornerRadius="8"
                Padding="16"
                Background="#3A1010"
                IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
            <StackPanel Spacing="12">
                <Grid ColumnDefinitions="Auto,*">
                    <PathIcon Grid.Column="0"
                              Data="{StaticResource SemiIconClose}"
                              Width="20" Height="20"
                              Foreground="#E06060"
                              VerticalAlignment="Top"
                              Margin="0,2,8,0" />
                    <TextBlock Grid.Column="1"
                               Text="{Binding ErrorMessage}"
                               TextWrapping="Wrap"
                               Foreground="#FFB0B0"
                               LineHeight="20" />
                </Grid>

                <Button HorizontalAlignment="Right"
                        Command="{Binding LaunchServerCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource SemiIconRefresh}" Width="16" Height="16" />
                        <TextBlock Text="{DynamicResource WizardKeepWaitingButton}" VerticalAlignment="Center" />
                    </StackPanel>
                </Button>
            </StackPanel>
        </Border>

        <!-- Informational Text -->
        <TextBlock Text="{DynamicResource WizardWaitingForServer}"
                   TextWrapping="Wrap"
                   FontSize="14"
                   TextAlignment="Center"
                   Foreground="{DynamicResource SemiTextSecondaryBrush}"
                   IsVisible="{Binding IsLoading}" />
    </StackPanel>
</UserControl>
